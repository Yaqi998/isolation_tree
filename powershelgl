$source = "C:\path\to\input"
$destination = "C:\path\to\aggregated_files"

# Create the destination folder if it doesn't exist
if (!(Test-Path $destination)) {
    New-Item -ItemType Directory -Path $destination
}

# Copy all files from subfolders to destination
Get-ChildItem -Path $source -Recurse -File | ForEach-Object {
    Copy-Item $_.FullName -Destination $destination
}

Write-Host "Done copying all files."
