import pandas as pd
import matplotlib.pyplot as plt
from matplotlib_venn import venn5, get_labels

# Assume your big DataFrame is called `df`
# And the column indicating hyperparam setting is 'hyperparam'

# Define the key columns for intersection
key_cols = ['partition', 'minute_of_the_week', 'date']

# Get unique hyperparams
hyperparams = df['hyperparam'].unique()

# Create sets of unique identifiers per hyperparam
sets = {
    h: set(map(tuple, df[df['hyperparam'] == h][key_cols].values))
    for h in hyperparams
}

# Select first 5 hyperparams if there are more
selected_hparams = list(sets.keys())[:5]
selected_sets = [sets[h] for h in selected_hparams]

# Generate subset labels (binary string keys like '11010') for venn5
labels = get_labels(selected_sets, fill='number')

# Plot
venn5(subsets=labels, set_labels=selected_hparams)
plt.title("Overlap of Runs Between Hyperparameter Settings")
plt.show()
